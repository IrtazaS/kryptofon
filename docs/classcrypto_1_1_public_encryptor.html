<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>VoIP Kryptofon: crypto.PublicEncryptor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="namespacecrypto.html">crypto</a>      </li>
      <li><a class="el" href="classcrypto_1_1_public_encryptor.html">PublicEncryptor</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a>  </div>
  <div class="headertitle">
<h1>crypto.PublicEncryptor Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="crypto::PublicEncryptor" -->
<p>Implements public part of the asymmetric cipher (with public key) used to send encrypted local secret key (used for symmetric ciphering of peer-to-peer datagram packets) to remote peer.  
<a href="#_details">More...</a></p>
<!-- startSectionHeader --><div class="dynheader">
Collaboration diagram for crypto.PublicEncryptor:<!-- endSectionHeader --></div>
<!-- startSectionSummary --><!-- endSectionSummary --><!-- startSectionContent --><div class="dyncontent">
<div class="center"><img src="classcrypto_1_1_public_encryptor__coll__graph.png" border="0" usemap="#crypto_8_public_encryptor_coll__map" alt="Collaboration graph"/></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center><!-- endSectionContent --></div>

<p><a href="classcrypto_1_1_public_encryptor-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a6d17a84c04cba13710e3f1dc51f73496">PublicEncryptor</a> (String <a class="el" href="classcrypto_1_1_public_encryptor.html#afe6d02d0f184d8f35edb1849bdad8213">serializedPublicKey</a>, String remoteUserId)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Deserializes public key from the Base64 string and instantiates <a class="el" href="classcrypto_1_1_public_encryptor.html" title="Implements public part of the asymmetric cipher (with public key) used to send encrypted local secret...">PublicEncryptor</a>.  <a href="#a6d17a84c04cba13710e3f1dc51f73496"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#aed1f1bdf60dd9fd2122b822ef38a0e11">isActive</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns if cipher is properly initialized.  <a href="#aed1f1bdf60dd9fd2122b822ef38a0e11"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#aa74763a92a6776fe395082648042ba4a">isVerified</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns if public key was verified.  <a href="#aa74763a92a6776fe395082648042ba4a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a1810fce92903f30a71a66a2f044bc879">getVerificatorName</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns if name of the verificator from authorized keys that verified this public key.  <a href="#a1810fce92903f30a71a66a2f044bc879"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">byte[]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a8e28776ed04b044082b2c8449ac6e15b">encrypt</a> (byte[] plainText)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts plain text using public key.  <a href="#a8e28776ed04b044082b2c8449ac6e15b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a6878ebbadfd0bb40aba369d2068e2b2f">encryptAndSerialize</a> (Serializable object)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns Base64 of encrypted (using our public key) object.  <a href="#a6878ebbadfd0bb40aba369d2068e2b2f"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a81244af39a3d61836fa0b0f104e07363">loadAuthorizedPublicKeys</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads authorized keys.  <a href="#a81244af39a3d61836fa0b0f104e07363"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a9fb8487034d956504e1e70f6e631274c">verifyObject</a> (SignedObject object)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies signed object with a public key from the authorized public keys.  <a href="#a9fb8487034d956504e1e70f6e631274c"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a35095933cacb0cd391d982c552ef3ddb">createEmptyAuthorizedPublicKeys</a> (String filename)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create empty authorized keys file if it does not exist and adjust permissions.  <a href="#a35095933cacb0cd391d982c552ef3ddb"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">PublicKey&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a4f35094db711bef701625902c72e7296">publicKey</a> = null</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Public key.  <a href="#a4f35094db711bef701625902c72e7296"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Cipher&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a2d805496e296e0e6ca57a3de8eb409b8">cipher</a> = null</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Instance of the encrypting engine based on remote public key.  <a href="#a2d805496e296e0e6ca57a3de8eb409b8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#afe6d02d0f184d8f35edb1849bdad8213">serializedPublicKey</a> = null</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Remote public key: serialized and encoded as Base64 string.  <a href="#afe6d02d0f184d8f35edb1849bdad8213"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a18fc10b61001b04986a2ca5e62682613">verificator</a> = null</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains name of the verificator (i.e the name associated with authorized public key that has verified this public key).  <a href="#a18fc10b61001b04986a2ca5e62682613"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static final String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a71aca86a1d0724f7d9b9bf2540f8e801">padding</a> = &quot;/ECB/PKCS1PADDING&quot;</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Padding to be used when ciphering/deciphering JCE does not support RSA/CBC so the CBC mode is built on the top of ECB in <a class="el" href="classcrypto_1_1_public_encryptor.html#a8e28776ed04b044082b2c8449ac6e15b" title="Encrypts plain text using public key.">PublicEncryptor.encrypt()</a>.  <a href="#a71aca86a1d0724f7d9b9bf2540f8e801"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static final String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a96d058411c482a7aba6f3d491b064c21">digest</a> = &quot;SHA1&quot;</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Message digest used for creating/validating signatures.  <a href="#a96d058411c482a7aba6f3d491b064c21"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static final String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a5d36021d1b285f45d14b721d61d8846b">authorizedKeysFile</a> = &quot;mykf-authorized-keys.txt&quot;</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The name of the file holding authorized public keys of remote peers.  <a href="#a5d36021d1b285f45d14b721d61d8846b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static ArrayList&lt; <a class="el" href="classcrypto_1_1_named_public_key.html">NamedPublicKey</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrypto_1_1_public_encryptor.html#a87df7100a22d709f109965e26de3c957">authorizedKeys</a> = null</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Authorized public keys (loaded from file)  <a href="#a87df7100a22d709f109965e26de3c957"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Implements public part of the asymmetric cipher (with public key) used to send encrypted local secret key (used for symmetric ciphering of peer-to-peer datagram packets) to remote peer. </p>
<p>The class holds also list of authorized public keys, which is used to verify signed objects received from peers.</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Mikica B Kocic </dd></dl>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00034">34</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a6d17a84c04cba13710e3f1dc51f73496"></a><!-- doxytag: member="crypto::PublicEncryptor::PublicEncryptor" ref="a6d17a84c04cba13710e3f1dc51f73496" args="(String serializedPublicKey, String remoteUserId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">crypto.PublicEncryptor.PublicEncryptor </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"> <em>serializedPublicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"> <em>remoteUserId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deserializes public key from the Base64 string and instantiates <a class="el" href="classcrypto_1_1_public_encryptor.html" title="Implements public part of the asymmetric cipher (with public key) used to send encrypted local secret...">PublicEncryptor</a>. </p>
<p>Verifies public key with the public key retrieved from the authorized keys. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00084">84</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>References <a class="el" href="_public_encryptor_8java_source.html#l00066">crypto.PublicEncryptor.cipher</a>, <a class="el" href="_public_encryptor_8java_source.html#l00041">crypto.PublicEncryptor.padding</a>, <a class="el" href="_public_encryptor_8java_source.html#l00061">crypto.PublicEncryptor.publicKey</a>, <a class="el" href="_public_encryptor_8java_source.html#l00071">crypto.PublicEncryptor.serializedPublicKey</a>, <a class="el" href="_public_encryptor_8java_source.html#l00078">crypto.PublicEncryptor.verificator</a>, and <a class="el" href="_public_encryptor_8java_source.html#l00275">crypto.PublicEncryptor.verifyObject()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="comment">/* Deserialize and verify public key used for encryption.</span>
<span class="comment">         */</span>
        this.<a class="code" href="classcrypto_1_1_public_encryptor.html#afe6d02d0f184d8f35edb1849bdad8213" title="Remote public key: serialized and encoded as Base64 string.">serializedPublicKey</a> = <a class="code" href="classcrypto_1_1_public_encryptor.html#afe6d02d0f184d8f35edb1849bdad8213" title="Remote public key: serialized and encoded as Base64 string.">serializedPublicKey</a>;

        <span class="keywordflow">try</span>
        {
            Object <span class="keywordtype">object</span> = Base64.decodeToObject( this.<a class="code" href="classcrypto_1_1_public_encryptor.html#afe6d02d0f184d8f35edb1849bdad8213" title="Remote public key: serialized and encoded as Base64 string.">serializedPublicKey</a> );
            SignedObject signedObject = null;

            <span class="keywordflow">if</span> ( <span class="keywordtype">object</span> instanceof SignedObject ) 
            {
                signedObject = (SignedObject) <span class="keywordtype">object</span>;
                this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a18fc10b61001b04986a2ca5e62682613" title="Contains name of the verificator (i.e the name associated with authorized public key that has verifie...">verificator</a> = <a class="code" href="classcrypto_1_1_public_encryptor.html#a6d17a84c04cba13710e3f1dc51f73496" title="Deserializes public key from the Base64 string and instantiates PublicEncryptor.">PublicEncryptor</a>.verifyObject( signedObject );
                <span class="keywordtype">object</span> = signedObject.getObject ();
            }
            
            <span class="keywordflow">if</span> ( <span class="keywordtype">object</span> instanceof PublicKey ) 
            {
                this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a4f35094db711bef701625902c72e7296" title="Public key.">publicKey</a> = (PublicKey)<span class="keywordtype">object</span>;
                String algorithm = this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a4f35094db711bef701625902c72e7296" title="Public key.">publicKey</a>.getAlgorithm (); 
                this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a2d805496e296e0e6ca57a3de8eb409b8" title="Instance of the encrypting engine based on remote public key.">cipher</a> = Cipher.getInstance( algorithm + <a class="code" href="classcrypto_1_1_public_encryptor.html#a71aca86a1d0724f7d9b9bf2540f8e801" title="Padding to be used when ciphering/deciphering JCE does not support RSA/CBC so the CBC mode is built o...">padding</a> );
            }
        }
        <span class="keywordflow">catch</span>( ClassNotFoundException e )
        {
            <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.exception( <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.WARN, e );
        }
        <span class="keywordflow">catch</span>( NoSuchAlgorithmException e )
        {
            <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.exception( <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.WARN, e );
        }
        <span class="keywordflow">catch</span>( NoSuchPaddingException e )
        {
            <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.exception( <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.WARN, e );
        }
        <span class="keywordflow">catch</span>( IOException e )
        {
            <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.exception( <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.WARN, e );
        }

        <span class="comment">/* If failed to create serializedPublicKey, then fail for good.</span>
<span class="comment">         */</span>
        <span class="keywordflow">if</span> ( this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a4f35094db711bef701625902c72e7296" title="Public key.">publicKey</a> == null )
        {
            this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a2d805496e296e0e6ca57a3de8eb409b8" title="Instance of the encrypting engine based on remote public key.">cipher</a> = null;
        }
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a35095933cacb0cd391d982c552ef3ddb"></a><!-- doxytag: member="crypto::PublicEncryptor::createEmptyAuthorizedPublicKeys" ref="a35095933cacb0cd391d982c552ef3ddb" args="(String filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void crypto.PublicEncryptor.createEmptyAuthorizedPublicKeys </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"> <em>filename</em>&#160;)</td>
          <td><code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create empty authorized keys file if it does not exist and adjust permissions. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00138">138</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>Referenced by <a class="el" href="_public_encryptor_8java_source.html#l00177">crypto.PublicEncryptor.loadAuthorizedPublicKeys()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">try</span>
        {
            File file = <span class="keyword">new</span> File( filename );

            <span class="keywordflow">if</span> (  ! file.exists () ) {
                file.createNewFile ();
            }

            <span class="keywordflow">if</span> (  file.exists () )
            {
                <span class="comment">/* Change permissions using native OS &#39;chmod&#39; command (ignoring Windows), </span>
<span class="comment">                 * so that no one but the owner might read its contents.</span>
<span class="comment">                 */</span>
                String osName = System.getProperty( <span class="stringliteral">&quot;os.name&quot;</span> ).toLowerCase();
                <span class="keywordflow">if</span> ( ! osName.matches( <span class="stringliteral">&quot;^.*windows.*$&quot;</span> ) ) 
                {
                    <span class="keywordflow">try</span> 
                    {
                        Runtime.getRuntime().exec( <span class="keyword">new</span> String[] { <span class="stringliteral">&quot;chmod&quot;</span>, <span class="stringliteral">&quot;go=&quot;</span>, filename } );
                    }
                    <span class="keywordflow">catch</span>( IOException e ) 
                    {
                        <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.trace( <span class="stringliteral">&quot;Failed to do chmod; OS = &quot;</span> + osName );
                        <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.exception( <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.TRACE, e );
                    }
                }
            }
        }
        <span class="keywordflow">catch</span>( Exception e )
        {
            <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.exception( <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.ERROR, e );
        }
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a8e28776ed04b044082b2c8449ac6e15b"></a><!-- doxytag: member="crypto::PublicEncryptor::encrypt" ref="a8e28776ed04b044082b2c8449ac6e15b" args="(byte[] plainText)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">byte [] crypto.PublicEncryptor.encrypt </td>
          <td>(</td>
          <td class="paramtype">byte[]&#160;</td>
          <td class="paramname"> <em>plainText</em>&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Encrypts plain text using public key. </p>
<p>Emulates CBC (cipher-block chaining) using plain ECB. Why? -- Because JCE does not support RSA/CBC cipher (only RSA/ECB).</p>
<p>See <a href="http://en.wikipedia.org/wiki/Block_cipher_modes_of_operation#Cipher-block_chaining_.28CBC.29" target="_new">Cipher-block chaining (CBC)</a> </p>
<div align="center">
<img src="cbc_encryption.png" alt="cbc_encryption.png"/>
</div>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classcrypto_1_1_asymmetric_cipher.html#ab131ee6818da2f399483ab7b5ae7aadc" title="Decrypts cipher text using the private key.">AsymmetricCipher.decrypt</a> </dd></dl>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00342">342</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>References <a class="el" href="_public_encryptor_8java_source.html#l00066">crypto.PublicEncryptor.cipher</a>, and <a class="el" href="_public_encryptor_8java_source.html#l00061">crypto.PublicEncryptor.publicKey</a>.</p>

<p>Referenced by <a class="el" href="_public_encryptor_8java_source.html#l00394">crypto.PublicEncryptor.encryptAndSerialize()</a>, and <a class="el" href="_asymmetric_cipher_8java_source.html#l00472">crypto.AsymmetricCipher.sanityCheck()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> ( this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a2d805496e296e0e6ca57a3de8eb409b8" title="Instance of the encrypting engine based on remote public key.">cipher</a> == null ) {
            <span class="keywordflow">return</span> null;
        }

        byte[] output = null;
        
        <span class="keyword">synchronized</span>( this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a2d805496e296e0e6ca57a3de8eb409b8" title="Instance of the encrypting engine based on remote public key.">cipher</a> ) 
        {
            <span class="keywordflow">try</span> 
            {
                this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a2d805496e296e0e6ca57a3de8eb409b8" title="Instance of the encrypting engine based on remote public key.">cipher</a>.init( Cipher.ENCRYPT_MODE, <a class="code" href="classcrypto_1_1_public_encryptor.html#a4f35094db711bef701625902c72e7296" title="Public key.">publicKey</a> );
                
                <span class="comment">/* cipher.getBlockSize () returns always 0, so for the RSA</span>
<span class="comment">                 * we can calculate block size as output size - 11 octets overhead.</span>
<span class="comment">                 * e.g. 117 octets for 1024-bit RSA key size (= 1024/8 - 11 )</span>
<span class="comment">                 */</span>
                <span class="keywordtype">int</span> blockSize = <a class="code" href="classcrypto_1_1_public_encryptor.html#a2d805496e296e0e6ca57a3de8eb409b8" title="Instance of the encrypting engine based on remote public key.">cipher</a>.getOutputSize( 1 ) - 11;
                
                ByteArrayOutputStream bOut = <span class="keyword">new</span> ByteArrayOutputStream ();
                
                byte[] xorBlock = <span class="keyword">new</span> byte[ blockSize ];

                <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> pos = 0; pos &lt; plainText.length; pos += blockSize ) 
                {
                    <span class="keywordtype">int</span> len = Math.min( plainText.length - pos, blockSize );
                    
                    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; len; ++i ) {
                        xorBlock[i] = (byte)( xorBlock[i] ^ plainText[ pos + i ] );
                    }

                    byte[] cipherBlock = this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a2d805496e296e0e6ca57a3de8eb409b8" title="Instance of the encrypting engine based on remote public key.">cipher</a>.doFinal( xorBlock, 0, len );
                    bOut.write( cipherBlock );

                    System.arraycopy( cipherBlock, 0, xorBlock, 0, blockSize );
                }

                output = bOut.toByteArray ();
            }
            <span class="keywordflow">catch</span>( Exception e )
            {
                <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.exception( <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.ERROR, e );
            }
        }

        <span class="keywordflow">return</span> output;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a6878ebbadfd0bb40aba369d2068e2b2f"></a><!-- doxytag: member="crypto::PublicEncryptor::encryptAndSerialize" ref="a6878ebbadfd0bb40aba369d2068e2b2f" args="(Serializable object)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">String crypto.PublicEncryptor.encryptAndSerialize </td>
          <td>(</td>
          <td class="paramtype">Serializable&#160;</td>
          <td class="paramname"> <em>object</em>&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns Base64 of encrypted (using our public key) object. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00394">394</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>References <a class="el" href="_public_encryptor_8java_source.html#l00342">crypto.PublicEncryptor.encrypt()</a>.</p>

<p>Referenced by <a class="el" href="_crypto_phone_app_8java_source.html#l01857">CryptoPhoneApp.acceptIncomingCall()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="comment">// TODO sign object first with our public key !</span>

        String result = null;
        
        <span class="comment">/* Serialize instance of the secret key into secret key file</span>
<span class="comment">         */</span>
        ByteArrayOutputStream bOut = null; 
        ObjectOutputStream oOut = null;
        
        <span class="keywordflow">try</span>
        {
            bOut = <span class="keyword">new</span> ByteArrayOutputStream ();
            oOut = <span class="keyword">new</span> ObjectOutputStream( bOut );
            oOut.writeObject( <span class="keywordtype">object</span> );
            
            byte[] plainText = bOut.toByteArray ();
            
            oOut.close ();
            bOut.close ();
            
            result = Base64.encodeBytes( <a class="code" href="classcrypto_1_1_public_encryptor.html#a8e28776ed04b044082b2c8449ac6e15b" title="Encrypts plain text using public key.">encrypt</a>( plainText ), Base64.GZIP );
        }
        <span class="keywordflow">catch</span>( Exception e ) 
        {
            <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.exception( <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.ERROR, e );
        }
        
        <span class="keywordflow">return</span> result;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a1810fce92903f30a71a66a2f044bc879"></a><!-- doxytag: member="crypto::PublicEncryptor::getVerificatorName" ref="a1810fce92903f30a71a66a2f044bc879" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">String crypto.PublicEncryptor.getVerificatorName </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns if name of the verificator from authorized keys that verified this public key. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>name of the verificator; May be null indicating not verified public key </dd></dl>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00326">326</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>References <a class="el" href="_public_encryptor_8java_source.html#l00078">crypto.PublicEncryptor.verificator</a>.</p>

<p>Referenced by <a class="el" href="_crypto_phone_app_8java_source.html#l01554">CryptoPhoneApp.deferredOnRing()</a>, and <a class="el" href="_crypto_phone_app_8java_source.html#l01775">CryptoPhoneApp.tryToVerifyInvitingCall()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">return</span> this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a18fc10b61001b04986a2ca5e62682613" title="Contains name of the verificator (i.e the name associated with authorized public key that has verifie...">verificator</a>;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="aed1f1bdf60dd9fd2122b822ef38a0e11"></a><!-- doxytag: member="crypto::PublicEncryptor::isActive" ref="aed1f1bdf60dd9fd2122b822ef38a0e11" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boolean crypto.PublicEncryptor.isActive </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns if cipher is properly initialized. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00308">308</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>References <a class="el" href="_public_encryptor_8java_source.html#l00066">crypto.PublicEncryptor.cipher</a>.</p>

<p>Referenced by <a class="el" href="_crypto_phone_app_8java_source.html#l01857">CryptoPhoneApp.acceptIncomingCall()</a>, <a class="el" href="_crypto_phone_app_8java_source.html#l01554">CryptoPhoneApp.deferredOnRing()</a>, and <a class="el" href="_crypto_phone_app_8java_source.html#l01775">CryptoPhoneApp.tryToVerifyInvitingCall()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">return</span> this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a2d805496e296e0e6ca57a3de8eb409b8" title="Instance of the encrypting engine based on remote public key.">cipher</a> != null;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="aa74763a92a6776fe395082648042ba4a"></a><!-- doxytag: member="crypto::PublicEncryptor::isVerified" ref="aa74763a92a6776fe395082648042ba4a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boolean crypto.PublicEncryptor.isVerified </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns if public key was verified. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00316">316</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>References <a class="el" href="_public_encryptor_8java_source.html#l00078">crypto.PublicEncryptor.verificator</a>.</p>

<p>Referenced by <a class="el" href="_crypto_phone_app_8java_source.html#l01857">CryptoPhoneApp.acceptIncomingCall()</a>, <a class="el" href="_crypto_phone_app_8java_source.html#l01554">CryptoPhoneApp.deferredOnRing()</a>, and <a class="el" href="_crypto_phone_app_8java_source.html#l01775">CryptoPhoneApp.tryToVerifyInvitingCall()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">return</span> this.<a class="code" href="classcrypto_1_1_public_encryptor.html#a18fc10b61001b04986a2ca5e62682613" title="Contains name of the verificator (i.e the name associated with authorized public key that has verifie...">verificator</a> != null;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a81244af39a3d61836fa0b0f104e07363"></a><!-- doxytag: member="crypto::PublicEncryptor::loadAuthorizedPublicKeys" ref="a81244af39a3d61836fa0b0f104e07363" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void crypto.PublicEncryptor.loadAuthorizedPublicKeys </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Loads authorized keys. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00177">177</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>References <a class="el" href="_public_encryptor_8java_source.html#l00056">crypto.PublicEncryptor.authorizedKeys</a>, <a class="el" href="_public_encryptor_8java_source.html#l00051">crypto.PublicEncryptor.authorizedKeysFile</a>, <a class="el" href="_named_public_key_8java_source.html#l00026">crypto.NamedPublicKey.comment</a>, <a class="el" href="_public_encryptor_8java_source.html#l00138">crypto.PublicEncryptor.createEmptyAuthorizedPublicKeys()</a>, and <a class="el" href="_cipher_engine_8java_source.html#l00057">crypto.CipherEngine.getPrivateKeyDirectory()</a>.</p>

<p>Referenced by <a class="el" href="_cipher_engine_8java_source.html#l00132">crypto.CipherEngine.initialize()</a>, and <a class="el" href="_cipher_engine_8java_source.html#l00209">crypto.CipherEngine.reloadAuthorizedPublicKeys()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        StringBuffer report = <span class="keyword">new</span> StringBuffer ();

        ArrayList&lt;NamedPublicKey&gt; newAuthKeys = <span class="keyword">new</span> ArrayList&lt;NamedPublicKey&gt; ();

        <span class="keywordflow">try</span> 
        {
            String filePath = CipherEngine.getPrivateKeyDirectory ()
                            + <a class="code" href="classcrypto_1_1_public_encryptor.html#a5d36021d1b285f45d14b721d61d8846b" title="The name of the file holding authorized public keys of remote peers.">authorizedKeysFile</a>;
            
            <a class="code" href="classcrypto_1_1_public_encryptor.html#a35095933cacb0cd391d982c552ef3ddb" title="Create empty authorized keys file if it does not exist and adjust permissions.">createEmptyAuthorizedPublicKeys</a>( filePath );

            FileReader inf = <span class="keyword">new</span> FileReader( filePath );
            BufferedReader ins = <span class="keyword">new</span> BufferedReader( inf );

            String line;
            <span class="keywordflow">while</span> ( ( line = ins.readLine () ) != null ) 
            {
                <span class="comment">/* Split line into &#39;words&#39;; Our key should be the first word </span>
<span class="comment">                 */</span>
                String[] parts = line.trim().split( <span class="stringliteral">&quot;\\s{1,}&quot;</span> );
                
                <span class="comment">/* Skip empty lines</span>
<span class="comment">                 */</span>
                <span class="keywordflow">if</span> ( parts.length &lt; 1 || parts[0].length () &lt;= 0 ) {
                    <span class="keywordflow">continue</span>;
                }

                <span class="comment">/* Skip lines starting with &#39;#&#39; (comments) </span>
<span class="comment">                 */</span>
                <span class="keywordflow">if</span> ( parts[0].equals( <span class="stringliteral">&quot;#&quot;</span> ) ) {
                    <span class="keywordflow">continue</span>;
                }

                <span class="comment">/* Now, deserialize public key from the first word</span>
<span class="comment">                 */</span>
                String encodedKey = parts[0];
                Object <span class="keywordtype">object</span> = null;

                <span class="keywordflow">try</span> {
                    <span class="keywordtype">object</span> = Base64.decodeToObject( encodedKey.toString () );
                }
                <span class="keywordflow">catch</span>( IOException e )
                {
                    <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.warn( <span class="stringliteral">&quot;Failed to deserialize authorized key at line: [&quot;</span> + encodedKey + <span class="stringliteral">&quot;]&quot;</span> );
                    <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.exception( <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.WARN, e );
                }
                <span class="keywordflow">catch</span>( ClassNotFoundException e )
                {
                    <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.warn( <span class="stringliteral">&quot;Failed to deserialize authorized key at line: [&quot;</span> + encodedKey + <span class="stringliteral">&quot;]&quot;</span> );
                    <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.exception( <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.WARN, e );
                }

                <span class="keywordflow">if</span> ( <span class="keywordtype">object</span> != null &amp;&amp; ( <span class="keywordtype">object</span> instanceof NamedPublicKey ) ) 
                {
                    NamedPublicKey authKey = (NamedPublicKey) <span class="keywordtype">object</span>; 
                    newAuthKeys.add( authKey );
                    <span class="keywordflow">if</span> ( report.length () != 0 ) {
                        report.append( <span class="stringliteral">&quot;, &quot;</span> );
                    }
                    report.append( authKey.comment );
                }
                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <span class="keywordtype">object</span> != null )
                {
                    <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.warn( <span class="stringliteral">&quot;Line: [&quot;</span> + encodedKey + <span class="stringliteral">&quot;]&quot;</span> );
                    <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.warn( <span class="stringliteral">&quot;Ignored class: &quot;</span> + <span class="keywordtype">object</span>.getClass().toString () );
                }
            }
        }
        <span class="keywordflow">catch</span>( FileNotFoundException e )
        {
            <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.exception( <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.TRACE, e );
        }
        <span class="keywordflow">catch</span>( IOException e )
        {
            <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.exception( <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.WARN, e );
        }

        <span class="keywordflow">if</span> ( newAuthKeys.size() &gt; 1 ) 
        {
            report.insert( 0,  <span class="stringliteral">&quot;Loaded &quot;</span> + newAuthKeys.size() + <span class="stringliteral">&quot; authorized keys: &quot;</span> );
            <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.attn( report.toString () );
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( newAuthKeys.size() == 1 ) 
        {
            report.insert( 0,  <span class="stringliteral">&quot;Loaded authorized key: &quot;</span> );
            <a class="code" href="namespaceutils.html#acdfe27a467c82e100aa74ce6d94e9b71" title="Common application message logger facility (static implementation)">Log</a>.attn( report.toString () );
        }

        <a class="code" href="classcrypto_1_1_public_encryptor.html#a87df7100a22d709f109965e26de3c957" title="Authorized public keys (loaded from file)">authorizedKeys</a> = newAuthKeys;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a9fb8487034d956504e1e70f6e631274c"></a><!-- doxytag: member="crypto::PublicEncryptor::verifyObject" ref="a9fb8487034d956504e1e70f6e631274c" args="(SignedObject object)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static String crypto.PublicEncryptor.verifyObject </td>
          <td>(</td>
          <td class="paramtype">SignedObject&#160;</td>
          <td class="paramname"> <em>object</em>&#160;)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verifies signed object with a public key from the authorized public keys. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>not null if verified with the name associated to authorized public key </dd></dl>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00275">275</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>References <a class="el" href="_public_encryptor_8java_source.html#l00056">crypto.PublicEncryptor.authorizedKeys</a>, <a class="el" href="_public_encryptor_8java_source.html#l00046">crypto.PublicEncryptor.digest</a>, and <a class="el" href="_public_encryptor_8java_source.html#l00078">crypto.PublicEncryptor.verificator</a>.</p>

<p>Referenced by <a class="el" href="_asymmetric_cipher_8java_source.html#l00598">crypto.AsymmetricCipher.deserializeEncryptedSecretKey()</a>, and <a class="el" href="_public_encryptor_8java_source.html#l00084">crypto.PublicEncryptor.PublicEncryptor()</a>.</p>
<div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">if</span> ( <a class="code" href="classcrypto_1_1_public_encryptor.html#a87df7100a22d709f109965e26de3c957" title="Authorized public keys (loaded from file)">authorizedKeys</a> == null ) {
            <span class="keywordflow">return</span> null;
        }

        String <a class="code" href="classcrypto_1_1_public_encryptor.html#a18fc10b61001b04986a2ca5e62682613" title="Contains name of the verificator (i.e the name associated with authorized public key that has verifie...">verificator</a> = null;

        <span class="keywordflow">for</span> ( NamedPublicKey authKey : <a class="code" href="classcrypto_1_1_public_encryptor.html#a87df7100a22d709f109965e26de3c957" title="Authorized public keys (loaded from file)">authorizedKeys</a> )
        {
            <span class="keywordflow">try</span> 
            {
                String signAlgorithm = <a class="code" href="classcrypto_1_1_public_encryptor.html#a96d058411c482a7aba6f3d491b064c21" title="Message digest used for creating/validating signatures.">digest</a> + <span class="stringliteral">&quot;with&quot;</span> + authKey.publicKey.getAlgorithm ();
                
                Signature signature = Signature.getInstance( signAlgorithm );
                
                <span class="keywordflow">if</span> ( <span class="keywordtype">object</span>.verify( authKey.publicKey, signature ) ) {
                    verificator = authKey.comment;
                    <span class="keywordflow">break</span>;
                }
            }
            <span class="keywordflow">catch</span>( Exception e )
            {
                <span class="comment">/* ignore all errors; search until exhausted keys or verify succeeds */</span>
            }
        }
        
        <span class="keywordflow">return</span> <a class="code" href="classcrypto_1_1_public_encryptor.html#a18fc10b61001b04986a2ca5e62682613" title="Contains name of the verificator (i.e the name associated with authorized public key that has verifie...">verificator</a>;
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a87df7100a22d709f109965e26de3c957"></a><!-- doxytag: member="crypto::PublicEncryptor::authorizedKeys" ref="a87df7100a22d709f109965e26de3c957" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ArrayList&lt;<a class="el" href="classcrypto_1_1_named_public_key.html">NamedPublicKey</a>&gt; <a class="el" href="classcrypto_1_1_public_encryptor.html#a87df7100a22d709f109965e26de3c957">crypto.PublicEncryptor.authorizedKeys</a> = null<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Authorized public keys (loaded from file) </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00056">56</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>Referenced by <a class="el" href="_public_encryptor_8java_source.html#l00177">crypto.PublicEncryptor.loadAuthorizedPublicKeys()</a>, and <a class="el" href="_public_encryptor_8java_source.html#l00275">crypto.PublicEncryptor.verifyObject()</a>.</p>

</div>
</div>
<a class="anchor" id="a5d36021d1b285f45d14b721d61d8846b"></a><!-- doxytag: member="crypto::PublicEncryptor::authorizedKeysFile" ref="a5d36021d1b285f45d14b721d61d8846b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">final String <a class="el" href="classcrypto_1_1_public_encryptor.html#a5d36021d1b285f45d14b721d61d8846b">crypto.PublicEncryptor.authorizedKeysFile</a> = &quot;mykf-authorized-keys.txt&quot;<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The name of the file holding authorized public keys of remote peers. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00051">51</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>Referenced by <a class="el" href="_public_encryptor_8java_source.html#l00177">crypto.PublicEncryptor.loadAuthorizedPublicKeys()</a>.</p>

</div>
</div>
<a class="anchor" id="a2d805496e296e0e6ca57a3de8eb409b8"></a><!-- doxytag: member="crypto::PublicEncryptor::cipher" ref="a2d805496e296e0e6ca57a3de8eb409b8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Cipher <a class="el" href="classcrypto_1_1_public_encryptor.html#a2d805496e296e0e6ca57a3de8eb409b8">crypto.PublicEncryptor.cipher</a> = null<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Instance of the encrypting engine based on remote public key. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00066">66</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>Referenced by <a class="el" href="_public_encryptor_8java_source.html#l00342">crypto.PublicEncryptor.encrypt()</a>, <a class="el" href="_public_encryptor_8java_source.html#l00308">crypto.PublicEncryptor.isActive()</a>, and <a class="el" href="_public_encryptor_8java_source.html#l00084">crypto.PublicEncryptor.PublicEncryptor()</a>.</p>

</div>
</div>
<a class="anchor" id="a96d058411c482a7aba6f3d491b064c21"></a><!-- doxytag: member="crypto::PublicEncryptor::digest" ref="a96d058411c482a7aba6f3d491b064c21" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">final String <a class="el" href="classcrypto_1_1_public_encryptor.html#a96d058411c482a7aba6f3d491b064c21">crypto.PublicEncryptor.digest</a> = &quot;SHA1&quot;<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Message digest used for creating/validating signatures. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00046">46</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>Referenced by <a class="el" href="_public_encryptor_8java_source.html#l00275">crypto.PublicEncryptor.verifyObject()</a>.</p>

</div>
</div>
<a class="anchor" id="a71aca86a1d0724f7d9b9bf2540f8e801"></a><!-- doxytag: member="crypto::PublicEncryptor::padding" ref="a71aca86a1d0724f7d9b9bf2540f8e801" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">final String <a class="el" href="classcrypto_1_1_public_encryptor.html#a71aca86a1d0724f7d9b9bf2540f8e801">crypto.PublicEncryptor.padding</a> = &quot;/ECB/PKCS1PADDING&quot;<code> [static, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Padding to be used when ciphering/deciphering JCE does not support RSA/CBC so the CBC mode is built on the top of ECB in <a class="el" href="classcrypto_1_1_public_encryptor.html#a8e28776ed04b044082b2c8449ac6e15b" title="Encrypts plain text using public key.">PublicEncryptor.encrypt()</a>. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00041">41</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>Referenced by <a class="el" href="_public_encryptor_8java_source.html#l00084">crypto.PublicEncryptor.PublicEncryptor()</a>.</p>

</div>
</div>
<a class="anchor" id="a4f35094db711bef701625902c72e7296"></a><!-- doxytag: member="crypto::PublicEncryptor::publicKey" ref="a4f35094db711bef701625902c72e7296" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PublicKey <a class="el" href="classcrypto_1_1_public_encryptor.html#a4f35094db711bef701625902c72e7296">crypto.PublicEncryptor.publicKey</a> = null<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Public key. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00061">61</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>Referenced by <a class="el" href="_public_encryptor_8java_source.html#l00342">crypto.PublicEncryptor.encrypt()</a>, and <a class="el" href="_public_encryptor_8java_source.html#l00084">crypto.PublicEncryptor.PublicEncryptor()</a>.</p>

</div>
</div>
<a class="anchor" id="afe6d02d0f184d8f35edb1849bdad8213"></a><!-- doxytag: member="crypto::PublicEncryptor::serializedPublicKey" ref="afe6d02d0f184d8f35edb1849bdad8213" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">String <a class="el" href="classcrypto_1_1_public_encryptor.html#afe6d02d0f184d8f35edb1849bdad8213">crypto.PublicEncryptor.serializedPublicKey</a> = null<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Remote public key: serialized and encoded as Base64 string. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00071">71</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>Referenced by <a class="el" href="_public_encryptor_8java_source.html#l00084">crypto.PublicEncryptor.PublicEncryptor()</a>.</p>

</div>
</div>
<a class="anchor" id="a18fc10b61001b04986a2ca5e62682613"></a><!-- doxytag: member="crypto::PublicEncryptor::verificator" ref="a18fc10b61001b04986a2ca5e62682613" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">String <a class="el" href="classcrypto_1_1_public_encryptor.html#a18fc10b61001b04986a2ca5e62682613">crypto.PublicEncryptor.verificator</a> = null<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Contains name of the verificator (i.e the name associated with authorized public key that has verified this public key). </p>
<p>Not null indicates that the public key was successfully verified. </p>

<p>Definition at line <a class="el" href="_public_encryptor_8java_source.html#l00078">78</a> of file <a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a>.</p>

<p>Referenced by <a class="el" href="_public_encryptor_8java_source.html#l00326">crypto.PublicEncryptor.getVerificatorName()</a>, <a class="el" href="_public_encryptor_8java_source.html#l00316">crypto.PublicEncryptor.isVerified()</a>, <a class="el" href="_public_encryptor_8java_source.html#l00084">crypto.PublicEncryptor.PublicEncryptor()</a>, and <a class="el" href="_public_encryptor_8java_source.html#l00275">crypto.PublicEncryptor.verifyObject()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>crypto/<a class="el" href="_public_encryptor_8java_source.html">PublicEncryptor.java</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Thu Dec 16 2010 14:44:44 for VoIP Kryptofon by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
